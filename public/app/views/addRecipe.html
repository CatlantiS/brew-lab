<app-view role="*">
    <h1 class="page-header brew-header">Create a new recipe</h1>

    <div class="recipe brew-form">
        <p class="brew-info">Time to shine.</p>

        <div ng-controller="AddRecipeCtrl as ctrl">
            <form name="ctrl.recipeForm" novalidate>
                <div class="form-group">
                    <label id="recipeNameLabel" for="recipeName">Recipe name</label>

                    <input type="text" name="name" class="form-control brew-input brew-input-required" id="recipeName" ng-model="ctrl.recipe.name"
                           aria-labelledby="recipeNameLabel" required aria-required="true" title="Provide a name for your recipe."
                           placeholder="Enter recipe name (required)">
                </div>

                <div class="form-group">
                    <label id="recipeVolumeLabel" for="recipeVolume">Volume</label>

                    <div class="input-group">
                        <input type="number" step="0.25" min="0" class="form-control brew-input" id="recipeVolume" ng-model="ctrl.recipe.volume"
                               aria-labelledby="recipeVolumeLabel" aria-required="false" title="Provide a numeric recipe volume."
                               placeholder="Enter numeric recipe volume (optional)">

                        <div class="input-group-btn" dropdown>
                            <button id="recipeUnits" type="button" class="btn btn-default dropdown-toggle" dropdown-toggle>
                                {{ ctrl.recipe.units || 'Units' }} <span class="caret"></span>
                            </button>
                            <ul class="dropdown-menu" role="menu" aria-labelledby="recipeUnits">
                                <li role="menuitem" ng-repeat="units in ctrl.units">
                                    <a href="#" ng-click="ctrl.recipe.units = units">{{ units }}</a>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>

                <label id="recipeYeastLabel" for="recipeYeast">Yeast</label>

                <div class="form-inline">
                    <input type="text" class="form-control brew-input" id="recipeYeast" ng-model="ctrl.current.yeast.name"
                           aria-labelledby="recipeYeastLabel" aria-required="false" title="Provide yeast name."
                           placeholder="Yeast name"
                           typeahead="yeastType for yeastType in ctrl.yeasts">

                    <div class="input-group brew-inline-input-group">
                        <input type="number" step="0.01" min="0" class="form-control brew-input" id="recipeYeastVolume" ng-model="ctrl.current.yeast.volume"
                               aria-required="false" title="Provide numeric yeast volume." placeholder="Yeast volume">

                        <div class="input-group-btn" dropdown>
                            <button id="recipeYeastUnits" type="button" class="btn btn-default dropdown-toggle" dropdown-toggle>
                                {{ ctrl.current.yeast.units || 'Units' }} <span class="caret"></span>
                            </button>
                            <ul class="dropdown-menu" role="menu" aria-labelledby="recipeYeastUnits">
                                <li role="menuitem" ng-repeat="units in ctrl.units">
                                    <a href="#" ng-click="ctrl.current.yeast.units = units">{{ units }}</a>
                                </li>
                            </ul>
                        </div>
                    </div>

                    <button type="submit" class="btn btn-primary pull-right" role="button"
                            ng-click="ctrl.addYeast(ctrl.current.yeast)"
                            ng-disabled="ctrl.current.yeast == null">Add</button>
                </div>

                <div ng-show="ctrl.recipe.yeasts != null && ctrl.recipe.yeasts.length > 0">
                    <table class="table table-responsive table-striped">
                        <thead>
                            <tr>
                                <th>Name</th>
                                <th>Volume</th>
                                <th>Units</th>
                                <th></th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr ng-repeat="yeast in ctrl.recipe.yeasts">
                                <td>
                                    {{ yeast.name }}
                                </td>
                                <td>
                                    {{ yeast.volume }}
                                </td>
                                <td>
                                    {{ yeast.units }}
                                </td>
                                <td class="row-delete">
                                    <a class="delete-icon" href="javascript:void(0);" title="Delete" ng-click="ctrl.deleteYeast(yeast)"><i class="fa fa-trash brew-delete"></i></a>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <div class="pull-right">
                    <button type="submit" class="btn btn-default" role="button"
                            ng-click="ctrl.submit(ctrl.recipeForm.$valid)"
                            ng-disabled="ctrl.recipeForm.$invalid">Submit</button>
                    <a href="#" class="brew-clear-button-right" role="button" ng-click="ctrl.clear()">Clear</a>
                </div>
            </form>
        </div>
    </div>
</app-view>
