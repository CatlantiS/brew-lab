"use strict";function Molar(){}var molar=new Molar;!function(){Array.prototype.filter||(Array.prototype.filter=function(t){if(void 0===this||null===this)throw new TypeError;var r=Object(this),n=r.length>>>0;if("function"!=typeof t)throw new TypeError;for(var o=[],e=arguments.length>=2?arguments[1]:void 0,i=0;n>i;i++)if(i in r){var a=r[i];t.call(e,a,i,r)&&o.push(a)}return o}),Array.prototype.indexOf||(Array.prototype.indexOf=function(t,r){var n;if(null==this)throw new TypeError('"this" is null or not defined');var o=Object(this),e=o.length>>>0;if(0===e)return-1;var i=+r||0;if(Math.abs(i)===1/0&&(i=0),i>=e)return-1;for(n=Math.max(i>=0?i:e-Math.abs(i),0);e>n;){if(n in o&&o[n]===t)return n;n++}return-1}),Array.prototype.map||(Array.prototype.map=function(t,r){var n,o,e;if(null==this)throw new TypeError('"this" is null or not defined');var i=Object(this),a=i.length>>>0;if("function"!=typeof t)throw new TypeError(t+" is not a function");for(arguments.length>1&&(n=r),o=new Array(a),e=0;a>e;){var u,s;e in i&&(u=i[e],s=t.call(n,u,e,i),o[e]=s),e++}return o}),Array.prototype.some||(Array.prototype.some=function(t){if(null==this)throw new TypeError("Array.prototype.some called on null or undefined");if("function"!=typeof t)throw new TypeError;for(var r=Object(this),n=r.length>>>0,o=arguments.length>=2?arguments[1]:void 0,e=0;n>e;e++)if(e in r&&t.call(o,r[e],e,r))return!0;return!1})}(),function(){var t=molar.array=molar.array||{};t.first=function(t,r){if(!molar.isArray(t))throw"Arg is not an array.";if(!molar.isFunction(r))throw"Callback is not a function.";var n;return t.some(function(t){return r(t)?(n=t,!0):!1}),n},t.any=function(t){if(!molar.isArray(t))throw"Arg is not an array.";var r=Object(t).length>>>0;return r>0}}(),function(){Molar.prototype.isArray=function(t){return void 0!==t&&null!==t&&t instanceof Array},Molar.prototype.isUndefined=function(t){return void 0===t||"undefined"==typeof t},Molar.prototype.isFunction=function(t){return"function"==typeof t},Molar.prototype.through=function(){if(0===arguments.length)return void 0;if(1===arguments.length)return arguments[0];for(var t=new Array(arguments.length),r=0;r<t.length;r++)t[r]=arguments[r];return t}}();var molar=molar||new Molar;!function(){function t(t,r){this.allowDuplicate=t,this.ttl=r,this.collection=[]}function r(t,r,n,o){this.key=t,this.value=r,this.timestamp=n,this.expiration=o}function n(t){return t.expiration&&t.expiration<new Date}function o(t){return function(r){return t.some(function(t){return t===r.key})}}t.prototype.add=function(t,n){if(this.allowDuplicate!==!1||!this.contains(t)){var o,e=new Date;return isNaN(this.ttl)||(o=(new Date).setMinutes(e.getMinutes()+this.ttl)),this.collection.push(new r(t,n,e,o)),!0}return!1},t.prototype["import"]=function(t,r,n){n=molar.isFunction(n)?n:molar.through;for(var o=0;o<t.length;o++){var e=t[o];this.add(r(e),n(e))}return this},t.prototype.removeBy=function(t){for(var r=[],n=0,o=0;o<this.collection.length;o++)t(this.collection[o])&&r.unshift(o);for(var e=0;e<r.length;e++)this.collection.splice(r[e],1),n++;return n},t.prototype.removeFirst=function(t){for(var r,n=!1,o=0;o<this.collection.length;o++)if(t(this.collection[o])){r=o;break}return null!=r&&(this.collection.splice(r,1),n=!0),n},t.prototype.remove=function(t){var r=t;if(arguments.length>1){r=new Array(arguments.length);for(var n=0;n<r.length;n++)r[n]=arguments[n]}else molar.isArray(r)||(r=[r]);var e;if(this.allowDuplicate)e=this.removeBy(o(r));else{e=0;for(var i=this,a=0;a<r.length;a++)(function(t){i.removeFirst(function(n){return n.key===r[t]})&&e++})(a)}return e},t.prototype.removeExpired=function(){return this.removeBy(n)},t.prototype.findBy=function(t){var r=[],o=this.collection.filter(function(o){return n(o)?(r.push(o.key),!1):t(o)});return this.remove(r),o},t.prototype.findFirst=function(t){var r=[],o=molar.array.first(this.collection,function(o){return n(o)?(r.push(o.key),!1):t(o)});return this.remove(r),o},t.prototype.find=function(t){var r=t;if(arguments.length>1){r=new Array(arguments.length);for(var n=0;n<r.length;n++)r[n]=arguments[n]}else molar.isArray(r)||(r=[r]);var e;if(this.allowDuplicate)e=this.findBy(o(r));else{e=[];for(var i=this,a=0;a<r.length;a++)(function(t){e.push(i.findFirst(function(n){return n.key===r[t]}))})(a)}return e},t.prototype.contains=function(t){return null!=this.findFirst(function(r){return r.key===t})},t.prototype.values=function(){return this.collection.map(function(t){return t.value})},t.prototype.count=function(){return this.collection.length},molar["class"]=molar["class"]||{},Molar.prototype.Lookup=molar["class"].Lookup=t}();var molar=molar||new Molar;!function(){function t(){this.definitions=[]}function r(t,r){this.name=t,this.autoMap=r,this.maps=[]}t.prototype.register=function(t){return this.definitions.push(t),this},t.prototype.map=function(t,r){var n=molar.array.first(this.definitions,function(t){return t.name===r});if(null===n||molar.isUndefined(n))return null;var o={};if(molar.isArray(n.maps))for(var e=0;e<n.maps.length;e++){var i=n.maps[e];if(molar.isUndefined(i.condition)||molar.isFunction(i.condition)&&i.condition(t[i.source])){var a=molar.isFunction(i.transform)?i.transform:molar.through;o[i.target]=a(t[i.source])}}if(n.autoMap===!0)for(var u in t)t.hasOwnProperty(u)&&molar.isUndefined(o[u])&&(o[u]=t[u]);return o},r.prototype.define=function(t){return this.definition=t,this},r.prototype.addMap=function(t,r,n,o){return this.maps.push({source:t,target:r,transform:n,condition:o}),this},molar["class"]=molar["class"]||{},Molar.prototype.ObjectMapper=molar["class"].ObjectMapper=t,Molar.prototype.MapperDefinition=molar["class"].MapperDefinition=r}();